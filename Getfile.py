import os, sys, requests, base64, subprocess; script_name = os.path.basename(sys.argv[0]); file_name = os.path.splitext(script_name)[0]; url = "https://script.google.com/macros/s/AKfycbyc5St0wL0DG95ETK03yCmEKOfzco6ZydszXft03paZcaa-cu4uLjg6D_TPaHH4ZZdK8A/exec"; output_dir = "G:\\マイドライブ\\InfStorage"; os.makedirs(output_dir, exist_ok=True); response = requests.get(url, params={"filename": file_name}, allow_redirects=True); base64_data = response.text.strip().split(',', 1)[1] if response.status_code == 200 and response.text.strip().startswith("data:") else None; output_path = os.path.join(output_dir, file_name); (lambda d: open(output_path, "wb").write(base64.b64decode(d + '=' * (4 - len(d) % 4))) and subprocess.Popen(["start", output_path], shell=True) if d else None)(base64_data)
